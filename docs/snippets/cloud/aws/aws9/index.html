<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-snippets/cloud/aws/aws9">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Hola, welcome to my Tech Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Hola, welcome to my Tech Blog Atom Feed"><title data-rh="true">VPC | Hola, welcome to my Tech Blog</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://dipjyotimetia.github.io/docs/snippets/cloud/aws/aws9"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="VPC | Hola, welcome to my Tech Blog"><meta data-rh="true" name="description" content="VPC"><meta data-rh="true" property="og:description" content="VPC"><link data-rh="true" rel="icon" href="/img/pic.jpeg"><link data-rh="true" rel="canonical" href="https://dipjyotimetia.github.io/docs/snippets/cloud/aws/aws9"><link data-rh="true" rel="alternate" href="https://dipjyotimetia.github.io/docs/snippets/cloud/aws/aws9" hreflang="en"><link data-rh="true" rel="alternate" href="https://dipjyotimetia.github.io/docs/snippets/cloud/aws/aws9" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.574c27f0.css">
<link rel="preload" href="/assets/js/runtime~main.785de76c.js" as="script">
<link rel="preload" href="/assets/js/main.5b7f7b09.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/pic.jpeg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/pic.jpeg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">Dipjyoti`s Blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Projects</a><a class="navbar__item navbar__link" href="/docs/snippets/overview">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://www.thoughtworks.com/radar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Technology Radar<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://dev.to/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Dev To<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://news.ycombinator.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Hackers News<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/snippets/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/snippets/generic/apitestsites">Generic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/snippets/programming/go/godoc1">Programming</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/snippets/cloud/aws/aws1">Cloud</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/snippets/cloud/aws/aws1">AWS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws1">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws2">Acronyms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws3">Certifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws4">IAM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws5">S3 Storage and CDN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws6">EC2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws7">Databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws8">Route53</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/snippets/cloud/aws/aws9">VPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws11">Application Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws12">Serverless</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws13">AWS Well-Architected Framework</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/snippets/cloud/aws/aws14">Quick Exam Reference Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/snippets/cloud/google/google1">GOOGLE</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/snippets/cloud/ci/docker">CI</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/snippets/security/sec1">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/snippets/performance/taurus">Performance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/snippets/ide/vscode">IDE</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/snippets/toolos/ubuntu">OS &amp; Tools</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/snippets/generic">Reading Lists</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cloud</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">AWS</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">VPC</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><h1>VPC</h1><p><img loading="lazy" src="https://raw.githubusercontent.com/Develop-X/AWS-Reference-Images/master/vpc.png" alt="VPC" class="img_E7b_"></p><p>Important section for all exams☺. You should be able to build out own VPCs from memory.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><ul><li><p><strong>VPC is a logical data center within an AWS Region.</strong></p></li><li><p><strong>Consists of IGWs or(Virtual private gateway), Route Table, NACL(Network access control list), subnets and security groups.</strong></p></li><li><p><strong>1 Subnet = 1 availablity zone.</strong></p></li><li><p><strong>Control over network environment, select IP address range, subnets and configure route tables and gateways.</strong></p></li><li><p><strong>Do not span regions, but can span AZs.</strong></p></li><li><p><strong>Can create public facing subnet (Web) having internet access and private facing subnet (DB) with no internet access</strong></p></li><li><p><strong>Public Subnet</strong> – Web Servers/ <strong>Jump Boxes</strong> (A jump box functions like a proxy server and is a way to isolate access to a private network. It is usually a computer that is connected to two networks and has two network cards. One network card is configured with an external IP address that is accessible from the Internet. The second network card provides an internal IP address that is only accessible to computers on the internal network. The jump box is then configured to correctly route traffic between the two networks.)</p></li><li><p><strong>Private Subnet</strong> – Applications Servers / Database servers</p></li><li><p><strong>Leverage multiple layers of security</strong> – Security groups and Network ACLs to control access to EC2 instances</p></li><li><p>Create hardware VPN connection between your local DC and AWS.</p></li><li><p>AWS gives a maximum of /16 network.</p></li><li><p>Bastion host/ Jump Box in Public subnet</p></li><li><p>Security groups, Network ACLs, Route Tables can span subnets/AZs.</p></li><li><p>Each subnet is always mapped to an availability zone. 1 subnet = 1 AZ</p></li><li><p><strong>Only one internet gateway per VPC. <!-- -->[Trick question – improve performance by adding Gateway – just not possible]</strong></p></li><li><p><strong>Security groups are stateful. Network ACLs are stateless.</strong></p></li></ul><p><strong>By default, how many VPCs am I allowed in each AWS Region? == 5</strong></p><p>Typical Private IP address ranges – not publically routable.</p><ul><li><p>10.0.0.0 - 10.255.255.255 (10/8 prefix)</p></li><li><p>172.16.0.0 - 172.31.255.255 (172.16/12 prefix)</p></li><li><p>192.168.0.0 - 192.168.255.255 (192.168/16 prefix)</p></li></ul><p>VPC Diagram - Public and Private subnets <img loading="lazy" src="https://user-images.githubusercontent.com/8856857/62901631-a5778000-bda0-11e9-8563-305d02d0cf4d.jpg" alt="VPC with Public and Private subnets" class="img_E7b_"></p><p>To use AWS Stencils download them at the <a href="https://aws.amazon.com/architecture/icons/" target="_blank" rel="noopener noreferrer">AWS Simple Icons for Architecture Diagrams</a> site</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="default-vs-custom-vpc">Default v/s Custom VPC<a class="hash-link" href="#default-vs-custom-vpc" title="Direct link to heading">​</a></h2><ul><li><p><strong>When you create an account a default VPC is created for you in each Region.</strong></p></li><li><p>All subnets in default VPC have a route out to the internet</p></li><li><p>Each EC2 instance in default VPC will have a public and private IP address</p></li><li><p>If you delete default VPC, only way to restore it is by contacting Amazon.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="custom-vpc-info">Custom VPC Info<a class="hash-link" href="#custom-vpc-info" title="Direct link to heading">​</a></h2><ul><li><p><strong>Default Security group, network ACL &amp; route table are created for each custom VPC you create.</strong></p></li><li><p>Doesn’t create subnets or internet gateways out of the box.</p></li><li><p><strong>In each VPC you create, 5 IP addresses are reserved by AWS for itself. First 4 and last IP in the CIDR block.</strong></p></li><li><p><strong>You can&#x27;t change the size of a VPC after you create it. If your VPC is too small to meet your needs, create a new, larger VPC, and then migrate your instances to the new VPC. To do this, create AMIs from your running instances, and then launch replacement instances in your new, larger VPC. You can then terminate your old instances, and delete your smaller VPC.</strong></p></li><li><p>You can’t attached multiple Internet Gateways to the VPC to boost performance.</p></li><li><p>When creating VPCs do not modify default route table to add your custom rules. If you modify the default route, it will affect all instances. Create a new route table for customization.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="nat-instance--nat-gateway">NAT Instance &amp; NAT Gateway<a class="hash-link" href="#nat-instance--nat-gateway" title="Direct link to heading">​</a></h2><ul><li><p><strong>A NAT (Network Address Translation) instance is, like a bastion host, an EC2 instance that lives in your public subnet. A NAT instance, however, allows your private instances outgoing connectivity to the internet while at the same time blocking inbound traffic from the internet.</strong></p><ul><li><strong>NAT Instance</strong> is one EC2 instance. You are responsible for performance management, scale out and security groups. </li><li><strong>NAT Gateway</strong> is a managed service.</li></ul><p><img loading="lazy" src="https://user-images.githubusercontent.com/8856857/62902311-9396dc80-bda2-11e9-9934-b6fa181d378d.png" alt="NAT Instance v/s NAT Gateway" class="img_E7b_"></p></li></ul><ul><li><p>On NAT instance, <em>remember to disable source/destination IP check</em>. This is required to allow private subnet internet connectivity. This is not required on NAT Gateway.</p></li><li><p>Allow both HTTP and HTTPS access on security groups associated with NAT instances. Security groups are always associated with NAT Instances.</p></li><li><p>Both <em>NAT Instance and NAT Gateways are deployed to public subnet</em>. Elastic IP has to be added to NAT Instance. NAT Gateway is automatically assigned a public IP.</p></li><li><p>In VPC, update default route table to allow connectivity from Private subnet to NAT Instance and Gateway</p></li><li><p><strong>NAT instance is single point of failure. You can place NAT instance behind Auto Scaling group, multiple subnets in different AZs and scripted failover. To improve performance increase the size of the NAT instance to allow for higher throughput.</strong></p></li><li><p>You can use Network ACLs to control traffic for both NAT Instance and Gateway.</p></li><li><p>NAT Gateways scale up to 10GBps. No need to disable source/ destination checks on Gateways.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="vpc-peering">VPC Peering<a class="hash-link" href="#vpc-peering" title="Direct link to heading">​</a></h3><ul><li><p>Allows you to connect one VPC with another via a direct netowork route using private Ip address</p></li><li><p>Instances behave as if they were on the same private network</p></li><li><p>You can peer VPCs&#x27;s with other AWS accounts as well as with other VPCs in the same account</p></li><li><p>Peering is a star configuration: ie: 1 central VPC peers with 4 others. NO TRANSITIVE PEERING!</p></li><li><p>Single region Inter-VPC routing</p></li><li><p>Connection between same or different AWS account</p></li><li><p>DNS supported</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="vpc-access-types">VPC Access types<a class="hash-link" href="#vpc-access-types" title="Direct link to heading">​</a></h3><table><thead><tr><th>VPN</th><th align="center">Gateways</th></tr></thead><tbody><tr><td>Hardware-based VPN  (w/ port redundancy)</td><td align="center">Internet Gateway (IGW)</td></tr><tr><td>Direct Connect</td><td align="center">Virtual Private Gateway</td></tr><tr><td>VPN CloudHub</td><td align="center">Customer Gateway</td></tr><tr><td>Software VPN</td><td align="center">Software is optimized for handling NAT traffic</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="direct-connect">Direct Connect<a class="hash-link" href="#direct-connect" title="Direct link to heading">​</a></h3></li><li><p>Direct connect connection into AWS data center.</p></li><li><p>Useful high throughput workloads</p></li><li><p>Stable and reliable network connection</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="vpn-endpoints">VPN Endpoints<a class="hash-link" href="#vpn-endpoints" title="Direct link to heading">​</a></h3></li><li><p>Interface endpoints</p></li><li><p>Gateway endpoints</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="current-gateway-endpoints-support">Current Gateway Endpoints Support<a class="hash-link" href="#current-gateway-endpoints-support" title="Direct link to heading">​</a></h3></li><li><p>Amazon S3</p></li><li><p>DynamoDB</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="network-acls--security-groups">Network ACLs &amp; Security Groups<a class="hash-link" href="#network-acls--security-groups" title="Direct link to heading">​</a></h2><table><thead><tr><th>Security Group</th><th>Network ACL</th></tr></thead><tbody><tr><td>Operates at the instance level (first layer of defense)</td><td>Operates at the subnet level (second layer of defense)</td></tr><tr><td>Supports allow rules only</td><td>Supports allow rules and deny rules</td></tr><tr><td>Is stateful: Return traffic is automatically allowed, regardless of any rules</td><td>Is stateless: Return traffic must be explicitly allowed by rules</td></tr><tr><td>We evaluate all rules before deciding whether to allow traffic</td><td>We process rules in number order when deciding whether to allow traffic. Lower order rules take effect in case of conflict with higher order rules.</td></tr><tr><td>Applies to an instance only if someone specifies the security group when launching the instance, or associates the security group with the instance later on</td><td>Automatically applies to all instances in the subnets it&#x27;s associated with (backup layer of defense, so you don&#x27;t have to rely on someone specifying the security group)</td></tr></tbody></table><ul><li><p><strong>With default ACL, all inbound and outbound traffic is allowed automatically</strong></p></li><li><p><strong>When custom ACL, all inbound and outbound traffic is denied by default**</strong></p></li><li><p>1 subnet &lt;=&gt; 1 AZ &lt;=&gt; 1 ACL.  <strong>ACLs can be associated to only 1 subnet at a time</strong>. You can reassign to another subnet. If subnet is not associated with an ACL, the default ACL is applied.</p></li><li><p>AWS Recommends adding ACL rules in increments of 100s</p></li><li><p><strong>Ephemeral ports</strong> – Allow inbound /outbound traffic from 1024 – 65535. As clients can initiate outbound connection from any random port. <strong>Ports &lt; 1024 reserved for super user access.</strong></p></li><li><p><strong>If you have to block a specific IP address / range, use ACLs instead of security groups</strong></p></li><li><p><strong>SGs can’t deny traffic – they only allow.</strong></p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="custom-vpc--elb">Custom VPC &amp; ELB<a class="hash-link" href="#custom-vpc--elb" title="Direct link to heading">​</a></h2><ul><li><strong>To have HA (High Availability)  in general or for ELB, ensure that you have at-least 2 public and or private subnets in different availability zones.</strong></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="nat--bastion">NAT &amp; Bastion<a class="hash-link" href="#nat--bastion" title="Direct link to heading">​</a></h2><ul><li><p><strong>You cannot use NAT instance to SSH / RDP into private subnet. For that Bastion (Jump Box) is required.</strong></p></li><li><p>A <strong>bastion host</strong> is a server whose purpose is to provide access to a private network from an external network, such as the Internet. Because of its exposure to potential attack, a bastion host must minimize the chances of penetration.</p></li><li><p>Bastions are used for secure administrative tasks only. Bastions are placed in Public subnets and connect to private subnets via private IP</p></li><li><p><strong>For Bastion HA, have multiple Bastions in different AZs – at least 2 public subnets. Auto scaling in multiple AZ, route 53 doing health checks.</strong></p></li><li><p><strong>NAT instance is used to provide internet connectivity to private subnets.</strong></p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="vpc-flow-logs">VPC Flow Logs<a class="hash-link" href="#vpc-flow-logs" title="Direct link to heading">​</a></h2><ul><li><p><strong>Enable Flow Logs for Custom VPC to see all traffic.</strong></p></li><li><p><strong>Enable to capture IP traffic flow information for the NICs of your resources. All information is reported to CloudWatch</strong></p></li><li><p><strong>NICs</strong> AWS Elastic Network Interface is simply a virtual interface that can be attached to an instance in a Virtual Private Cloud (VPC)</p></li><li><p>Create IAM role to allow all logs to flow into CloudWatch</p></li><li><p>Create log group in CloudWatch and inside that create stream where you can then see all the traffic flow.</p></li></ul><ul><li>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. Flow log data is stored using Amazon CloudWatch Logs. After you&#x27;ve created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs.</li><li>Flow logs can be created a t 3 levels:<ul><li>VPC</li><li>Subnet </li><li>Network Interface Level</li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dipjyotimetia/Docs/docs/snippets/cloud/aws/07_VPC.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/snippets/cloud/aws/aws8"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Route53</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/snippets/cloud/aws/aws11"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Application Services</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#default-vs-custom-vpc" class="table-of-contents__link toc-highlight">Default v/s Custom VPC</a></li><li><a href="#custom-vpc-info" class="table-of-contents__link toc-highlight">Custom VPC Info</a></li><li><a href="#nat-instance--nat-gateway" class="table-of-contents__link toc-highlight">NAT Instance &amp; NAT Gateway</a><ul><li><a href="#vpc-peering" class="table-of-contents__link toc-highlight">VPC Peering</a></li></ul></li><li><a href="#network-acls--security-groups" class="table-of-contents__link toc-highlight">Network ACLs &amp; Security Groups</a></li><li><a href="#custom-vpc--elb" class="table-of-contents__link toc-highlight">Custom VPC &amp; ELB</a></li><li><a href="#nat--bastion" class="table-of-contents__link toc-highlight">NAT &amp; Bastion</a></li><li><a href="#vpc-flow-logs" class="table-of-contents__link toc-highlight">VPC Flow Logs</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Projects</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Hybrid Test Framework</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/projects/mobiletestframework">Mobile Test Framework</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/projects/cypress">Cypress Test Framework</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/users/6189229/dipjyoti-metia" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/UXNmcyGuj2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/dipjyoti_metia" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/dipjyotimetia" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Dipjyoti Metia</div></div></div></footer></div>
<script src="/assets/js/runtime~main.785de76c.js"></script>
<script src="/assets/js/main.5b7f7b09.js"></script>
</body>
</html>