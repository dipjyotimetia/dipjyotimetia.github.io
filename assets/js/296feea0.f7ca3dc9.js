"use strict";(self.webpackChunktech_blog=self.webpackChunktech_blog||[]).push([[8742],{2813:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var s=t(5893),i=t(1151);const r={id:"jenkins",title:"Jenkins",sidebar_label:"Jenkins"},l=void 0,o={id:"snippets/cloud/ci/jenkins",title:"Jenkins",description:"To Allow html css in html publisher",source:"@site/docs/snippets/cloud/ci/jenkins.mdx",sourceDirName:"snippets/cloud/ci",slug:"/snippets/cloud/ci/jenkins",permalink:"/docs/snippets/cloud/ci/jenkins",draft:!1,unlisted:!1,editUrl:"https://github.com/dipjyotimetia/Docs/docs/snippets/cloud/ci/jenkins.mdx",tags:[],version:"current",frontMatter:{id:"jenkins",title:"Jenkins",sidebar_label:"Jenkins"},sidebar:"Docs",previous:{title:"Kubernetes",permalink:"/docs/snippets/cloud/ci/kubernetes"},next:{title:"Certificate generation",permalink:"/docs/snippets/security/sec1"}},a={},c=[{value:"To Allow html css in html publisher",id:"to-allow-html-css-in-html-publisher",level:3},{value:"Running different dockerfile in jenkins pipeline in different dir",id:"running-different-dockerfile-in-jenkins-pipeline-in-different-dir",level:3},{value:"Demo jenkisnfile for multibranch javascript",id:"demo-jenkisnfile-for-multibranch-javascript",level:3},{value:"Emailable Report",id:"emailable-report",level:3}];function d(e){const n={code:"code",h3:"h3",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h3,{id:"to-allow-html-css-in-html-publisher",children:"To Allow html css in html publisher"}),"\n",(0,s.jsx)(n.p,{children:"Go to jenkins script console and run the below command"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"System.setProperty(\"hudson.model.DirectoryBrowserSupport.CSP\", \"sandbox allow-same-origin allow-scripts; default-src 'self'; script-src * 'unsafe-eval'; img-src *; style-src * 'unsafe-inline'; font-src *\")\n"})}),"\n",(0,s.jsx)(n.p,{children:"or"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"System.setProperty(\"hudson.model.DirectoryBrowserSupport.CSP\", \"sandbox allow-scripts; default-src 'self'; img-src *; style-src 'self' 'unsafe-inline'; script-src * 'unsafe-inline';\")\n"})}),"\n",(0,s.jsx)(n.h3,{id:"running-different-dockerfile-in-jenkins-pipeline-in-different-dir",children:"Running different dockerfile in jenkins pipeline in different dir"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-groovy",children:"pipeline {\n   agent none\n   stages {\n       stage(\"Only Dockerfile in Project\") {\n\t     agent { dockerfile true }\n\t      steps {\n\t\t sh 'npm start'\n\t      }\n\t}\n        stage(\"Docker file under build folder\") {\n\t     agent {\n\t\tdockerfile {\n\t\t    dir 'build'\n\t\t  }\n\t      }\n\t      steps {\n\t\t sh 'npm start'\n\t      }\n\t}\n\tstage(\"Docker file for test under Tests folder\") {\n\t     agent {\n\t\tdockerfile {\n\t\t    dir 'E2ETests'\n\t\t  }\n\t      }\n\t      steps {\n\t\t sh 'npm test'\n\t      }\n\t}\n   }\n}   \n"})}),"\n",(0,s.jsx)(n.h3,{id:"demo-jenkisnfile-for-multibranch-javascript",children:"Demo jenkisnfile for multibranch javascript"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-groovy",children:"def buildVersion = ''\n\npipeline {\n  agent  { label 'win' }\n\ttriggers { cron('15 09 * * *') }\n\n    parameters {\n        string(name: 'exec_config', defaultValue: 'ENV', description: 'Default execution environment is ENV headless')\n    }\n\n\toptions {\n\t\t\tbuildDiscarder(logRotator(numToKeepStr: '10', artifactNumToKeepStr: '10'))\n\t\t}\n\n    stages {\n\t stage(\"Test ENV\") {\n\t\t\tsteps {\n\t\t\t\techo 'run tests'\n\t\t\t\tsh 'npm run test:headless'\n\t\t\t\techo \"${params.exec_config}\"\n\t\t\t\tsh \"npm run test:e2e:${params.exec_config}\"\n\t\t\t}\n\t\t}\n\n\t}\n\tpost {\n\t\talways {\n              allure includeProperties: false, jdk: '', results: [[path: 'allure-xml-results']]\n              publishHTML([allowMissing: false, alwaysLinkToLastBuild: false, keepAll: false, reportDir: 'allure-report', reportFiles: 'index.html', reportName: 'Allure Report', reportTitles: ''])\n\t\t}\n\t}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"emailable-report",children:"Emailable Report"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'Hi All,\n<br/>\nPlease find the execution detail and buildlog in attachment.\n<br/>\nReport url: /<br/>\n<br/>\n<pre>\n${FILE, path="build/testngOutput/emailable-report.html"}\n</pre>\n'})}),"\n",(0,s.jsx)(n.p,{children:"Attachments: Reports/*.html"})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>l});var s=t(7294);const i={},r=s.createContext(i);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);