"use strict";(self.webpackChunktech_blog=self.webpackChunktech_blog||[]).push([[6759],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return k}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=p(a),k=r,d=m["".concat(s,".").concat(k)]||m[k]||c[k]||i;return a?n.createElement(d,l(l({ref:t},u),{},{components:a})):n.createElement(d,l({ref:t},u))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},7837:function(e,t,a){a.r(t),a.d(t,{assets:function(){return u},contentTitle:function(){return s},default:function(){return k},frontMatter:function(){return o},metadata:function(){return p},toc:function(){return c}});var n=a(3117),r=a(102),i=(a(7294),a(3905)),l=["components"],o={id:"aws6",title:"EC2",sidebar_label:"EC2"},s="EC2 \u2013 The Backbone of AWS",p={unversionedId:"snippets/cloud/aws/aws6",id:"snippets/cloud/aws/aws6",title:"EC2",description:"EC2 101",source:"@site/docs/snippets/cloud/aws/04_EC2.md",sourceDirName:"snippets/cloud/aws",slug:"/snippets/cloud/aws/aws6",permalink:"/docs/snippets/cloud/aws/aws6",editUrl:"https://github.com/dipjyotimetia/Docs/docs/snippets/cloud/aws/04_EC2.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"aws6",title:"EC2",sidebar_label:"EC2"},sidebar:"Docs",previous:{title:"S3 Storage and CDN",permalink:"/docs/snippets/cloud/aws/aws5"},next:{title:"Databases",permalink:"/docs/snippets/cloud/aws/aws7"}},u={},c=[{value:"EC2 101",id:"ec2-101",level:2},{value:"EC2 Pricing",id:"ec2-pricing",level:3},{value:"EC2 Instance Types",id:"ec2-instance-types",level:3},{value:"EBS",id:"ebs",level:2},{value:"EC2 Security Groups",id:"ec2-security-groups",level:2},{value:"Volumes and Snapshots",id:"volumes-and-snapshots",level:2},{value:"EBS Volumes",id:"ebs-volumes",level:3},{value:"RAID, Volumes &amp; Snapshots.",id:"raid-volumes--snapshots",level:3},{value:"EBS backed v/s Instance store",id:"ebs-backed-vs-instance-store",level:2},{value:"EC2 Status Checks",id:"ec2-status-checks",level:2},{value:"System Status Checks",id:"system-status-checks",level:3},{value:"Instance Status Checks",id:"instance-status-checks",level:2},{value:"Load Balancers",id:"load-balancers",level:2},{value:"CloudWatch",id:"cloudwatch",level:2},{value:"AWS CLI Usage",id:"aws-cli-usage",level:2},{value:"IAM Roles for EC2",id:"iam-roles-for-ec2",level:2},{value:"Bootstrap scripts.",id:"bootstrap-scripts",level:2},{value:"EC2 Instance Meta-Data",id:"ec2-instance-meta-data",level:2},{value:"Auto Scaling 101",id:"auto-scaling-101",level:2},{value:"EC2 Placement groups",id:"ec2-placement-groups",level:2},{value:"EFS(Elastic File System)",id:"efselastic-file-system",level:2},{value:"Placement Groups",id:"placement-groups",level:2}],m={toc:c};function k(e){var t=e.components,a=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"ec2--the-backbone-of-aws"},"EC2 \u2013 The Backbone of AWS"),(0,i.kt)("h2",{id:"ec2-101"},"EC2 101"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Elastic Compute Cloud"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Provides ",(0,i.kt)("strong",{parentName:"p"},"resizable compute capacity in cloud (scale up and down)"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Helps developers failure resilient systems and isolate them"))),(0,i.kt)("h3",{id:"ec2-pricing"},"EC2 Pricing"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"On demand")," Pay per hour or per second of usage."),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Applications with short term, spiky usage patterns or unpredictable workloads that cannot be interrupted."),(0,i.kt)("li",{parentName:"ul"},"New apps on AWS being developed or tested on Amazon EC2 for the first time"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Reserved pricing")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Reserve capacity over significant period of time. Significant discount (up to 75%) compared to On-Demand instance pricing")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Applications with steady or predictable usage over a period of time.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Reserved capacity required.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Further discount if upfront payment"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Standard reserved instances(Cant covert t2 to R4)"),(0,i.kt)("li",{parentName:"ul"},"Convertible reserved instances (Can convert from t2 to t3 or t4)"),(0,i.kt)("li",{parentName:"ul"},"Scheduled reserved instances(In specific time instances)"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Spot pricing")),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Bid your price for compute. When bid price is higher than Spot price, then you can provision it. When it goes lower, instance is terminated. discount for up to 90% off the On-Demand price.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Useful for applications who have flexible start / stop times")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"urgent computing needs for large amounts of additional capacity")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Applications that are feasible only at very low compute prices. E.g. pharma simulations")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Applications with urgent computing capacity")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"[Exam Tip]"," ",(0,i.kt)("strong",{parentName:"p"},"If AWS terminates instance, you are not charged for partial hour. If you terminate, you will be charged for the hour."))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Dedicated Hosts"),"/ physical EC2 machines"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"physical EC2 server dedicated for your use. Dedicated Hosts can help you reduce costs by allowing you to use your existing server-bound software licenses, including Windows Server, SQL Server, and SUSE Linux Enterprise Server (subject to your license terms), and can also help you meet compliance requirements.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Can be purchased On-Demand (hourly).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Can be purchased as a Reservation for up to 70% off the On-Demand price.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Massive discount for reserved instances over a long period of time \u2013 upto 70% for 3 years.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Useful for regulatory requirements")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Certain licensing agreements prevent usage on virtual machine / multi-tenancy deployments."))))),(0,i.kt)("h3",{id:"ec2-instance-types"},"EC2 Instance Types"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Sr. No"),(0,i.kt)("th",{parentName:"tr",align:"center"},"Family"),(0,i.kt)("th",{parentName:"tr",align:"right"},"Specialty"),(0,i.kt)("th",{parentName:"tr",align:"right"},"Use Case"),(0,i.kt)("th",{parentName:"tr",align:"right"},"Type"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:"center"},"D2"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Dense Storage"),(0,i.kt)("td",{parentName:"tr",align:"right"},"File Servers / DWH / Hadoop"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Storage Optimized")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:"center"},"R4. R3"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Memory Optimized"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Memory Intensive / DBs"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Memory Optimized")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"3"),(0,i.kt)("td",{parentName:"tr",align:"center"},"M4. M3"),(0,i.kt)("td",{parentName:"tr",align:"right"},"General Purpose"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Application Servers"),(0,i.kt)("td",{parentName:"tr",align:"right"},"General Purpose")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4"),(0,i.kt)("td",{parentName:"tr",align:"center"},"C4, C3"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Compute Optimized"),(0,i.kt)("td",{parentName:"tr",align:"right"},"CPU Intensive Apps, DBs"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Compute O")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5"),(0,i.kt)("td",{parentName:"tr",align:"center"},"G2"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Graphics Intensive"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Video Encoding / 3D Application Streaming"),(0,i.kt)("td",{parentName:"tr",align:"right"})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"6"),(0,i.kt)("td",{parentName:"tr",align:"center"},"I2"),(0,i.kt)("td",{parentName:"tr",align:"right"},"High speed storage (IOPS)"),(0,i.kt)("td",{parentName:"tr",align:"right"},"NoSQL DBs, DWH"),(0,i.kt)("td",{parentName:"tr",align:"right"})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"7"),(0,i.kt)("td",{parentName:"tr",align:"center"},"F1"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Field Programmable Gate Array"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Hardware acceleration of Code"),(0,i.kt)("td",{parentName:"tr",align:"right"})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"8"),(0,i.kt)("td",{parentName:"tr",align:"center"},"T2"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Lowest Cost, General Purpose"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Web Servers/ Small DBs"),(0,i.kt)("td",{parentName:"tr",align:"right"},"General Purpose")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"9"),(0,i.kt)("td",{parentName:"tr",align:"center"},"P2"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Graphics / General Purpose GPU","[Parallel Processing]"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Machine Learning / Bit Coin Mining."),(0,i.kt)("td",{parentName:"tr",align:"right"})),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"10"),(0,i.kt)("td",{parentName:"tr",align:"center"},"X1"),(0,i.kt)("td",{parentName:"tr",align:"right"},"Memory Optimized"),(0,i.kt)("td",{parentName:"tr",align:"right"},"SAP HANA / Apache Spark"),(0,i.kt)("td",{parentName:"tr",align:"right"},"-")))),(0,i.kt)("p",null,"Acronym \u2013 *",(0,i.kt)("em",{parentName:"p"},"DIRT MCG FPX"),"  -"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"D \u2013 Density , I  - IOPS , R \u2013 RAM , T \u2013 cheap T2, M \u2013 Main Choice ( default) \u2013 Apps, C \u2013 Compute,  G \u2013 Graphics, F \u2013 FPGA , P \u2013 Graphics \u2013 Pics \u2013 Parallel Processing , X \u2013 Extreme Memory"),"  - *"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Use M3 for general purpose instances \u2013 balanced compute, memory and network resources")),(0,i.kt)("p",null,"[Exam Tip]"," You will be asked to provide which instance type to use for a given scenario. Usually 3 options are fictitious."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"TM-CR-X-P-HID")),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/8856857/62579559-6dc39080-b8e7-11e9-98be-3b15e4ed1626.jpg",alt:"Instance Types"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"EC2 Key Pairs are region specific")),(0,i.kt)("h2",{id:"ebs"},"EBS"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Block based storage"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"You can install OS, Database on it, unlike S3"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Placed in specific AZ. Automatically replicated within the AZ to protect from failure.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"[Exam Tips]","*  - ",(0,i.kt)("strong",{parentName:"p"},"EBS Volume Types")),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"SSD Drives")," (Solid state Drives)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"(root volume) General Purpose SSD")," \u2013 up to 16,000 IOPS. (Input/Output Operations Per Second) 3 IOPS per GB. Balances price and performance. You can    burst upto 3000 IOPS for 1GB")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"(root volume) Provisioned IOPS SSD")," \u2013 when you need more than 16,000 IOPS. Large RDBMS DBs and NoSQL DBs. Up to 64000 IOPS now"),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Magnetic Drives"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"HDD, Throughput Optimized\u2013 ST1")," \u2013 Required for data written in sequence. Big Data, DWH, Log processing. Cannot be used as boot volumes, 500 IOPS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"HDD, Cold\u2013 SC1")," \u2013 Data that isn\u2019t frequently accessed. E.g. File Server. Cannot be used as boot volume, 250 IOPS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"(root volume) HDD, Magnetic (Standard)")," \u2013 ",(0,i.kt)("strong",{parentName:"p"},"Cheapest bootable EBS volume type"),". Used for apps where data is less frequently accessed and low cost is    important, 40-200 IOPS."))),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/8856857/62581104-803fc900-b8eb-11e9-9140-30ee4e6dc667.png",alt:"EBS Volume Types"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"You cannot mount 1 EBS volume to multiple EC2 Instances. Use EFS instead."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"EBS Root Volumes can be encrypted on custom AMIs only"),". Not on the default available AMIs. To encrypt root volumes, create a new AMI and encrypt root volume. ",(0,i.kt)("strong",{parentName:"p"},"You can also encrypt using 3rd party software like Bit Locker"),". Additional volumes attached to EC2 instance can be encrypted.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"EC2 \u2013 1 subnet equals 1 Availability Zone.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Default VPC & Security group is created in when you create your account.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Default CloudWatch monitoring \u2013 every 5 mins. Can enable advanced monitoring to check at interval of each minute.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Volume \u2013 Virtual Hard Disk")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Tag everything on AWS")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Default Linux EC2 username is ec2-user")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Default Windows EC2 username is Administrator")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Termination protection is turned off by default. You need to turn it on.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"When instance is terminated, root volume is deleted. You can turn if off.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"System Status Check")," \u2013 Overall health of hosting infrastructure. If they arise, Terminate instance and recreate")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Instance Status Check")," \u2013 Health of instance. If they arise, reboot the instance."))),(0,i.kt)("h2",{id:"ec2-security-groups"},"EC2 Security Groups"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A ",(0,i.kt)("strong",{parentName:"p"},"security group is a virtual firewall."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"First line of defense. ",(0,i.kt)("strong",{parentName:"p"},"Network ACLs are second line."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},'1 instance can have multiple security groups. As each security group only "allows" inbound traffic, there will never be a conflict on security group rules.')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Security group changes are applied immediately.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},'Security groups are "STATEFUL".')," Rules added as inbound rules \u2013 automatic outbound rules are added. Response back on the same channel. ",(0,i.kt)("strong",{parentName:"p"},"NACLs (network access control list) are STATELESS."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"All inbound traffic is blocked by default.")," You have to allow specific inbound rules for protocols")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"All outbound traffic is allowed by default."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Only allow rules, no deny rules exist. Use NACLs to deny specific IPs"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Any number of EC2 instances in a security group.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"EC2 instances in the default security group can communicate with each other.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Multiple security groups can be attached to an instance."))),(0,i.kt)("h2",{id:"volumes-and-snapshots"},"Volumes and Snapshots"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Volumes are virtual hard disks."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can attach volume to EC2 instance belonging to same AZ")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"To Detach a volume from EC2 instance, you have to umount it first")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Snapshots are point in time copies of volumes \u2013 stored in S3.")," Taking first snapshot takes a while.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Subsequent snapshots will only store the delta in S3. Only changed blocks are stored in S3.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can create volumes from Snapshots. During this you can also change Volume Storage Type")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Volume is just block data. You need to format it create specific file system e.g. ext4")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Root Volume is one where OS is installed / booted. It is not encrypted by default on AWS AMIs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"AMI can be created from the both volumes and snapshot."))),(0,i.kt)("h3",{id:"ebs-volumes"},"EBS Volumes"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"EBS volume can be changed on the fly(except for magnetic standard)"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Best practice is to stop the EC2 instance and then change the volume")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can change volume types by taking a snapshot and then using the snapshot to create a new volume")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"If you change a volume on the fly you must wait for 6 hours before you make another change"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can scale EBS volume up only"))),(0,i.kt)("h3",{id:"raid-volumes--snapshots"},"RAID, Volumes & Snapshots."),(0,i.kt)("p",null,"(Redundant Array of Inexpensive Disks or Drives, or Redundant Array of Independent Disks)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"RAID 0 \u2013 Striped, No Redundancy , Good Performance \u2013 No Backup/Failover")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"RAID 1 \u2013 Mirrored, Redundancy")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"RAID 5 \u2013 Good for reads, bad for writes. ",(0,i.kt)("strong",{parentName:"p"},"AWS doesn\u2019t recommend using RAID 5 on EBS"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"RAID 10 \u2013 Raid 0 + Raid 1 - Good Redundancy , Good Performance - Done for very high I/O")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Use RAID Arrays when a single volume IOPs are not sufficient for your need. E.g. Database. Then you create RAID Array to meet IOPs requirements.")),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"- To take snapshot of RAID Array \u2013")),(0,i.kt)("ol",{parentName:"li"},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Stop the application from writing to cache and  flush all cache to Disk")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Freeze the file system")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Umount the RAID Array")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Shutdown the EC2 instance")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Snapshots of encrypted volumes are encrypted automatically.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can copy snapshot to another region while encrypting it.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Create Image from snapshot.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"The EC2 instance thus created will have root volume encrypted.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can\u2019t share encrypted snapshots as the encryption key is tied to your account."))),(0,i.kt)("h2",{id:"ebs-backed-vs-instance-store"},"EBS backed v/s Instance store"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},'An "EBS-backed" instance'),' is an EC2 instance which uses an EBS volume as it\'s root device. EBS volumes are redundant, "virtual" drives, which are not tied to any particular hardware, however they are restricted to a particular EC2 availability zone. ... You can think of EBS volumes as a kind of Network Attached Storage.')),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"The instance store")," is ideal for temporary storage, because the data stored in instance store volumes is not persistent through instance stops, terminations, or hardware failures."))),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/8856857/62652102-e6852400-b99d-11e9-93e3-b14ef207358f.jpg",alt:"EBS backed vs Instance store"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can reboot or terminate instance store backed EC2 VMs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can start, stop, reboot or terminate EBS backed EC2 VMs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"EC2 instance on instance store is lost if host hypervisor fails. Not so with EBS backed instances."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"EBS volumes can be attached / detached to EC2 instances. One at a time")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"EBS backed AMI is from EBS snapshot")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Instance store back volume is from template in S3. Hence slower to provision")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You will not lose data if you reboot for both.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"With EBS, you can ask AWS not to delete the volume upon instance termination."))),(0,i.kt)("h2",{id:"ec2-status-checks"},"EC2 Status Checks"),(0,i.kt)("p",null,"There are two types of status checks: system status checks and instance status checks."),(0,i.kt)("h3",{id:"system-status-checks"},"System Status Checks"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Monitor the AWS systems required to use your instance to ensure they are working properly. These checks detect problems with your instance that require AWS involvement to repair. When a system status check fails, you can choose to wait for AWS to fix the issue, or you can resolve it yourself (for example, by stopping and starting an instance, or by terminating and replacing an instance).")),(0,i.kt)("p",null,"The following are examples of problems that can cause system status checks to fail:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Loss of network connectivity")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Loss of system power")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Software issues on the physical host")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Hardware issues on the physical host that impact network reachability"))),(0,i.kt)("h2",{id:"instance-status-checks"},"Instance Status Checks"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Monitor the software and network configuration of your individual instance. These checks detect problems that require your involvement to repair. When an instance status check fails, typically you will need to address the problem yourself (for example, by rebooting the instance or by making instance configuration changes).")),(0,i.kt)("p",null,"The following are examples of problems that can cause instance status checks to fail:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Failed system status checks")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Incorrect networking or startup configuration")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Exhausted memory")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Corrupted file system")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Incompatible kernel"))),(0,i.kt)("h2",{id:"load-balancers"},"Load Balancers"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"The ",(0,i.kt)("strong",{parentName:"p"},"Classic Load Balancer")," that routes traffic based on either application or network level information, and the ",(0,i.kt)("strong",{parentName:"p"},"Application Load Balancer")," that routes traffic based on advanced application level information that includes the content of the request.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"The ",(0,i.kt)("strong",{parentName:"p"},"Classic Load Balancer is ideal for simple load balancing of traffic across multiple EC2 instances, while the Application Load Balancer is ideal for applications needing advanced routing capabilities, microservices, and container-based architectures"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Instances monitored by load balancers are reported as InService/OutOfService"))),(0,i.kt)("h2",{id:"cloudwatch"},"CloudWatch"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Default Metrics \u2013 Network, Disk , CPU and Status check ( Instance and System)"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Memory \u2013 RAM is a custom metric"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"You can create custom dashboards all CloudWatch metrics.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"CloudWatch alarms")," \u2013 set notifications when particular thresholds are hit.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"CloudWatch events")," help you respond to state changes. E.g. run Lambda function in response to.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"CloudWatch logs")," helps you monitor EC2 instance/application/system logs. Logs send data to CloudWatch")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Standard monitoring 5 mins. Detailed monitoring 1 minute - out of free tier.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"CloudWatch is for logging. CloudTrail is for auditing your calls.")))),(0,i.kt)("h2",{id:"aws-cli-usage"},"AWS CLI Usage"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Users can login with Access Key ID and Secret Access Key. If anything is compromised, you can regenerate the secret access key.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Also you can delete the user and recreate."))),(0,i.kt)("h2",{id:"iam-roles-for-ec2"},"IAM Roles for EC2"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Avoid using user credentials on servers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"IAM roles can be assigned/replaced to existing EC2 instances using AWS CLI. Not through the console.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A trick is to assign policies to the existing role. This will avoid the need to create new instances.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Role assigned to instance is stuck to the lifetime of the instance \u2013 until you delete the role. Easier to modify existing role by adding / removing policies."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Roles are universal. Applicable to all regions."))),(0,i.kt)("h2",{id:"bootstrap-scripts"},"Bootstrap scripts."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Scripts can be passed on to the EC2 instance at first boot time as part of user-data.")),(0,i.kt)("h2",{id:"ec2-instance-meta-data"},"EC2 Instance Meta-Data"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"curl ",(0,i.kt)("a",{parentName:"p",href:"http://169.254.169.254/latest/meta-data/"},"http://169.254.169.254/latest/meta-data/"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Instance information is available in Meta-Data. Not in User-Data"))),(0,i.kt)("h2",{id:"auto-scaling-101"},"Auto Scaling 101"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Before you can create Auto scaling group you need to create a launch configuration"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Launch Configuration \u2013 Select AMI, Instance Type , Bootstrap script"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"No actual instances are created just with launch configuration")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Auto scaling group")," \u2013 Set minimum size, spread it over subnets (AZs)- select all available AZs")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Run health checks from ELB"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"Configure Auto scaling policy \u2013 Based on Alarm take action \u2013 trigger a new instance creation when CPU Utilization is greater than 90% for 5 minutes. You can also delete instance based on alarms"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"When Auto scaling group is launched it creates the instances based on definition."))),(0,i.kt)("h2",{id:"ec2-placement-groups"},"EC2 Placement groups"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Logical grouping of instances within a single AZ")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Instances can participate in low latency, 10 GBPs network."))),(0,i.kt)("h2",{id:"efselastic-file-system"},"EFS(Elastic File System)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},"You pay only for the storage you use and can scale upto petabytes"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Unlike EBS, a EFS can be accessed by multiple EC2s - Acts like a central repository")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Supports the NFSv4 protocol")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Can support thousands of concurrent NFS connections")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Data is stored across multiple AZs withing a region")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Block based storage and not object based storage")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Has read after write consistency"),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/8856857/62652854-a6bf3c00-b99f-11e9-8214-67ddfa646545.png",alt:"S3-EFS-EBS"})))),(0,i.kt)("h2",{id:"placement-groups"},"Placement Groups"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"When you launch a new EC2 instance, the EC2 service attempts to place the instance in such a way that all of your instances are spread out across underlying hardware to minimize correlated failures."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"You can use placement groups to influence the placement of a group of interdependent instances to meet the needs of your workload.")),(0,i.kt)("li",{parentName:"ul"},"3 placement strategies",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Cluster")," \u2013 packs instances close together inside an Availability Zone. This strategy enables workloads to achieve the low-latency network performance necessary for tightly-coupled node-to-node communication that is typical of HPC applications."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Partition")," \u2013 spreads your instances across logical partitions such that groups of instances in one partition do not share the underlying hardware with groups of instances in different partitions. This strategy is typically used by large distributed and replicated workloads, such as Hadoop, Cassandra, and Kafka."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Spread"),"  strictly places a small group of instances across distinct underlying hardware to reduce correlated failures.")))))}k.isMDXComponent=!0}}]);